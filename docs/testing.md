# Manual & Automated Testing Instructions

## 1. Manual Test via test.html

You can test the WebGL viewer without running Shiny by using `www/test.html`.

### ⚠️ Important: Use an HTTP Server (not file://)

Modern browsers (especially Chrome) block ES modules and some scripts when opening HTML files directly from disk (file://).
**Always serve `test.html` via HTTP to ensure all features and external libraries load properly.**

#### Quick Start (Local Web Server Options)

- **Python (any OS):**
  ```sh
  python -m http.server 8000
  ```
  Then open [http://localhost:8000/www/test.html](http://localhost:8000/www/test.html) in your browser.

- **R (servr):**
  ```r
  servr::httw('www')
  ```
  Then browse to the provided URL.

- **R (httpuv):**
  ```r
  httpuv::startServer("0.0.0.0", 8000, list())
  ```

- **RStudio Viewer:**  
  You can also use:
  ```r
  rstudioapi::viewer("www/test.html")
  ```
  or, to open in an external browser:
  ```r
  browseURL("www/test.html")
  ```

### How to Use

* Use the file input at the top to select a `.tif` image, such as one generated by the helper R script (see below).
* The image should display interactively in the viewer.

## 2. Shiny App

* Run your Shiny app as usual (e.g., `shiny::runApp()`).
* The viewer should appear once the UI creates a container with `id='glviewer-container'`.
* If the container is added after DOMContentLoaded, the viewer will still initialize automatically.

## 3. Test Data Generation

There are two R scripts for generating synthetic test images:

* **Standard sample (96x64 voxels):**
  ```r
  source("R/generate_test_tiff.R")
  ```
  - Creates: `img/sample_cyl.tif` (96x64, 2-layer, 16-bit)
* **Small sample (36x20 voxels):**
  ```r
  source("R/generate_small_tiff.R")
  ```
  - Creates: `img/sample_cyl_36x20.tif` (36x20, 2-layer, 16-bit)

Both scripts generate two-layer, 16-bit TIFFs (radius and reflectivity). If the `{tiff}` package is not installed, the script will emit a message instead.

## 4. Notes

* The viewer instance is attached to `container.canvas.viewer`, so programmatic API and controls continue to work as before.
* For further debugging, open your browser's console.